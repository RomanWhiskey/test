<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система тестирования учеников</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .login-container, .test-selection, .test-container, .results, .admin-panel {
            display: none;
        }
        
        .active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .test-card {
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 5px solid #3498db;
        }
        
        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .test-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .test-info {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.9rem;
        }
        
        .question-container {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .question-number {
            color: #3498db;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .option {
            padding: 12px 15px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .option:hover {
            background-color: #e9ecef;
        }
        
        .option.selected {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-success {
            background-color: #28a745;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-danger {
            background-color: #dc3545;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #3498db;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
        }
        
        .results {
            text-align: center;
        }
        
        .results-icon {
            font-size: 4rem;
            color: #3498db;
            margin: 20px 0;
        }
        
        .score {
            font-size: 3rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
        }
        
        .grade {
            font-size: 1.5rem;
            color: #28a745;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .results-details {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: left;
        }
        
        .results-details h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .result-item {
            padding: 10px 0;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
        }
        
        .result-item.correct {
            color: #28a745;
        }
        
        .result-item.incorrect {
            color: #dc3545;
        }
        
        .time-info {
            font-style: italic;
            color: #6c757d;
            margin-top: 20px;
        }
        
        .student-info {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .admin-panel {
            text-align: left;
        }
        
        .admin-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .results-table th {
            background-color: #2c3e50;
            color: white;
            padding: 12px 15px;
            text-align: left;
        }
        
        .results-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .results-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .results-table tr:hover {
            background-color: #f1f1f1;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .badge-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: #6c757d;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            margin-top: 20px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #dee2e6;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .navigation {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .admin-controls {
                flex-direction: column;
            }
            
            .results-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-graduation-cap"></i> Система тестирования учеников</h1>
            <p class="subtitle">Проверьте свои знания по различным предметам</p>
        </header>
        
        <div class="content">
            <!-- Экран входа -->
            <div id="login-container" class="login-container active">
                <h2>Вход в систему тестирования</h2>
                <p>Для начала тестирования введите ваши данные</p>
                
                <div class="form-group">
                    <label for="last-name">Фамилия *</label>
                    <input type="text" id="last-name" placeholder="Иванов" required>
                </div>
                
                <div class="form-group">
                    <label for="first-name">Имя *</label>
                    <input type="text" id="first-name" placeholder="Иван" required>
                </div>
                
                <div class="form-group">
                    <label for="middle-name">Отчество</label>
                    <input type="text" id="middle-name" placeholder="Иванович">
                </div>
                
                <div class="form-group">
                    <label for="class">Класс</label>
                    <select id="class">
                        <option value="">Не выбран</option>
                        <option value="5">5 класс</option>
                        <option value="6">6 класс</option>
                        <option value="7">7 класс</option>
                        <option value="8">8 класс</option>
                        <option value="9">9 класс</option>
                        <option value="10">10 класс</option>
                        <option value="11">11 класс</option>
                    </select>
                </div>
                
                <button class="btn" id="start-test-btn">
                    Начать тестирование <i class="fas fa-arrow-right"></i>
                </button>
                
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
                    <p>Для просмотра результатов тестирования (учителю):</p>
                    <button class="btn btn-secondary" id="admin-login-btn">
                        <i class="fas fa-chart-bar"></i> Панель результатов
                    </button>
                </div>
            </div>
            
            <!-- Экран выбора теста -->
            <div id="test-selection" class="test-selection">
                <div class="student-info">
                    <h3 id="student-name">Иванов Иван Иванович</h3>
                    <p id="student-class">Класс: не указан</p>
                </div>
                
                <h2>Выберите тест</h2>
                <p>Выберите один из предложенных тестов для проверки знаний.</p>
                
                <div class="test-card" data-test="math">
                    <h3>Математика</h3>
                    <p>Тест по алгебре и геометрии для 7-9 классов. Включает 10 вопросов разного уровня сложности.</p>
                    <div class="test-info">
                        <span><i class="far fa-clock"></i> 15 минут</span>
                        <span><i class="far fa-question-circle"></i> 10 вопросов</span>
                    </div>
                </div>
                
                <div class="test-card" data-test="history">
                    <h3>История России</h3>
                    <p>Тест по ключевым событиям истории России с древних времен до XX века.</p>
                    <div class="test-info">
                        <span><i class="far fa-clock"></i> 20 минут</span>
                        <span><i class="far fa-question-circle"></i> 12 вопросов</span>
                    </div>
                </div>
                
                <div class="test-card" data-test="biology">
                    <h3>Биология</h3>
                    <p>Тест по общей биологии: ботаника, зоология, анатомия человека.</p>
                    <div class="test-info">
                        <span><i class="far fa-clock"></i> 18 минут</span>
                        <span><i class="far fa-question-circle"></i> 10 вопросов</span>
                    </div>
                </div>
                
                <div class="test-card" data-test="english">
                    <h3>Английский язык</h3>
                    <p>Тест на знание грамматики и лексики английского языка (базовый уровень).</p>
                    <div class="test-info">
                        <span><i class="far fa-clock"></i> 12 минут</span>
                        <span><i class="far fa-question-circle"></i> 8 вопросов</span>
                    </div>
                </div>
                
                <button class="btn btn-secondary" id="back-to-login">
                    <i class="fas fa-arrow-left"></i> Вернуться
                </button>
            </div>
            
            <!-- Экран тестирования -->
            <div id="test-container" class="test-container">
                <div class="student-info">
                    <h4 id="current-student-name">Иванов Иван Иванович</h4>
                    <p id="current-test-name">Тест: Математика</p>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progress-text">Вопрос 1 из 10</span>
                        <span id="timer">Осталось времени: 15:00</span>
                    </div>
                </div>
                
                <div id="question-container">
                    <!-- Вопросы будут загружены здесь -->
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="prev-btn" disabled>
                        <i class="fas fa-arrow-left"></i> Предыдущий вопрос
                    </button>
                    <button class="btn" id="next-btn">
                        Следующий вопрос <i class="fas fa-arrow-right"></i>
                    </button>
                    <button class="btn btn-success" id="submit-btn" style="display: none;">
                        Завершить тест <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
            
            <!-- Экран результатов -->
            <div id="results" class="results">
                <div class="student-info">
                    <h4 id="result-student-name">Иванов Иван Иванович</h4>
                    <p id="result-test-name">Тест: Математика</p>
                </div>
                
                <div class="results-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2>Тест завершен!</h2>
                <div class="score" id="final-score">0%</div>
                <div class="grade" id="grade">Оценка: Неудовлетворительно</div>
                <p id="result-message">Вы можете попробовать пройти тест еще раз для улучшения результата.</p>
                
                <div class="results-details">
                    <h3>Детализация результатов</h3>
                    <div id="results-list">
                        <!-- Детали результатов будут загружены здесь -->
                    </div>
                </div>
                
                <div class="time-info">
                    <p id="time-spent">Время прохождения: 0 минут</p>
                    <p id="completion-date">Дата прохождения: </p>
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="retry-btn">
                        <i class="fas fa-redo"></i> Пройти другой тест
                    </button>
                    <button class="btn" id="finish-btn">
                        <i class="fas fa-home"></i> Завершить
                    </button>
                </div>
            </div>
            
            <!-- Панель администратора для просмотра результатов -->
            <div id="admin-panel" class="admin-panel">
                <h2><i class="fas fa-chart-bar"></i> Панель результатов</h2>
                <p>Просмотр всех результатов тестирования учеников</p>
                
                <div class="admin-controls">
                    <div>
                        <label for="admin-password">Пароль для доступа:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="password" id="admin-password" placeholder="Введите пароль" style="width: auto;">
                            <button class="btn btn-secondary" id="admin-access-btn">
                                <i class="fas fa-unlock"></i> Войти
                            </button>
                        </div>
                        <p style="font-size: 0.8rem; margin-top: 5px; color: #666;">По умолчанию: teacher123</p>
                    </div>
                    
                    <div id="admin-controls" style="display: none;">
                        <button class="btn btn-danger" id="clear-results-btn">
                            <i class="fas fa-trash"></i> Очистить все результаты
                        </button>
                        <button class="btn btn-success" id="export-results-btn">
                            <i class="fas fa-download"></i> Экспорт в JSON
                        </button>
                    </div>
                </div>
                
                <div id="admin-content" style="display: none;">
                    <div class="tabs">
                        <button class="tab active" data-tab="results-tab">Результаты тестов</button>
                        <button class="tab" data-tab="stats-tab">Статистика</button>
                    </div>
                    
                    <div class="tab-content active" id="results-tab">
                        <div id="results-filter" style="margin-bottom: 20px;">
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <input type="text" id="filter-name" placeholder="Фильтр по ФИО" style="flex: 1; min-width: 200px;">
                                <select id="filter-test" style="width: 150px;">
                                    <option value="">Все тесты</option>
                                    <option value="math">Математика</option>
                                    <option value="history">История</option>
                                    <option value="biology">Биология</option>
                                    <option value="english">Английский</option>
                                </select>
                                <select id="filter-class" style="width: 120px;">
                                    <option value="">Все классы</option>
                                    <option value="5">5 класс</option>
                                    <option value="6">6 класс</option>
                                    <option value="7">7 класс</option>
                                    <option value="8">8 класс</option>
                                    <option value="9">9 класс</option>
                                    <option value="10">10 класс</option>
                                    <option value="11">11 класс</option>
                                </select>
                                <button class="btn btn-secondary" id="apply-filter">
                                    <i class="fas fa-filter"></i> Применить
                                </button>
                            </div>
                        </div>
                        
                        <div id="results-table-container">
                            <table class="results-table">
                                <thead>
                                    <tr>
                                        <th>ФИО</th>
                                        <th>Класс</th>
                                        <th>Тест</th>
                                        <th>Результат</th>
                                        <th>Оценка</th>
                                        <th>Дата</th>
                                        <th>Время</th>
                                    </tr>
                                </thead>
                                <tbody id="results-table-body">
                                    <!-- Результаты будут загружены здесь -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="no-results" class="empty-state" style="display: none;">
                            <i class="fas fa-clipboard-list"></i>
                            <h3>Нет результатов тестирования</h3>
                            <p>Пока никто не прошел тестирование. Результаты появятся здесь после прохождения тестов учениками.</p>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="stats-tab">
                        <div class="empty-state">
                            <i class="fas fa-chart-pie"></i>
                            <h3>Статистика тестирования</h3>
                            <p>Для просмотра статистики необходимо наличие результатов тестирования.</p>
                            <div id="stats-content" style="margin-top: 20px;">
                                <!-- Статистика будет здесь -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-secondary" id="back-from-admin">
                    <i class="fas fa-arrow-left"></i> Вернуться к тестированию
                </button>
            </div>
        </div>
        
        <footer>
            <p>Система тестирования учеников © 2023 | Все данные сохраняются в вашем браузере</p>
        </footer>
    </div>

    <script>
        // Данные тестов
        const tests = {
            math: {
                title: "Математика",
                timeLimit: 15,
                questions: [
                    {
                        question: "Чему равен квадратный корень из 64?",
                        options: ["6", "7", "8", "9"],
                        correct: 2
                    },
                    {
                        question: "Чему равна сумма углов треугольника?",
                        options: ["90°", "180°", "270°", "360°"],
                        correct: 1
                    },
                    {
                        question: "Решите уравнение: 2x + 5 = 15",
                        options: ["x = 5", "x = 7", "x = 10", "x = 15"],
                        correct: 0
                    },
                    {
                        question: "Чему равна площадь круга с радиусом 3? (π ≈ 3.14)",
                        options: ["9.42", "18.84", "28.26", "37.68"],
                        correct: 2
                    },
                    {
                        question: "Что такое гипотенуза?",
                        options: [
                            "Сторона прямоугольного треугольника, лежащая против прямого угла",
                            "Сторона прямоугольного треугольника, прилежащая к прямому углу",
                            "Высота треугольника",
                            "Медиана треугольника"
                        ],
                        correct: 0
                    },
                    {
                        question: "Чему равно значение выражения 3² + 4²?",
                        options: ["7", "12", "25", "49"],
                        correct: 2
                    },
                    {
                        question: "Какой из этих углов является острым?",
                        options: ["45°", "90°", "120°", "180°"],
                        correct: 0
                    },
                    {
                        question: "Чему равно значение π с точностью до двух знаков после запятой?",
                        options: ["3.14", "3.16", "3.18", "3.20"],
                        correct: 0
                    },
                    {
                        question: "Что такое простое число?",
                        options: [
                            "Число, которое делится только на 1 и на себя",
                            "Число, которое делится на 2",
                            "Любое натуральное число",
                            "Число с дробной частью"
                        ],
                        correct: 0
                    },
                    {
                        question: "Чему равен синус 30°?",
                        options: ["0", "0.5", "√2/2", "1"],
                        correct: 1
                    }
                ]
            },
            history: {
                title: "История России",
                timeLimit: 20,
                questions: [
                    {
                        question: "В каком году произошло Крещение Руси?",
                        options: ["862", "988", "1147", "1240"],
                        correct: 1
                    },
                    {
                        question: "Кто был первым императором России?",
                        options: ["Иван Грозный", "Петр I", "Екатерина II", "Александр I"],
                        correct: 1
                    },
                    {
                        question: "Когда началась Великая Отечественная война?",
                        options: ["1 сентября 1939", "22 июня 1941", "9 мая 1945", "7 ноября 1917"],
                        correct: 1
                    },
                    {
                        question: "Кто автор «Повести временных лет»?",
                        options: ["Нестор", "Иларион", "Владимир Мономах", "Александр Невский"],
                        correct: 0
                    },
                    {
                        question: "В каком году была отменена крепостное право в России?",
                        options: ["1762", "1861", "1905", "1917"],
                        correct: 1
                    },
                    {
                        question: "Кто победил в Куликовской битве?",
                        options: ["Монголо-татары", "Русские войска", "Польско-литовские войска", "Шведские войска"],
                        correct: 1
                    },
                    {
                        question: "Какой город был столицей Древней Руси?",
                        options: ["Москва", "Новгород", "Киев", "Владимир"],
                        correct: 2
                    },
                    {
                        question: "Кто был последним царем России?",
                        options: ["Александр II", "Александр III", "Николай I", "Николай II"],
                        correct: 3
                    },
                    {
                        question: "В каком году произошла Октябрьская революция?",
                        options: ["1905", "1914", "1917", "1922"],
                        correct: 2
                    },
                    {
                        question: "Кто был первым президентом России?",
                        options: ["Михаил Горбачев", "Борис Ельцин", "Владимир Путин", "Дмитрий Медведев"],
                        correct: 1
                    },
                    {
                        question: "Когда была принята Конституция Российской Федерации?",
                        options: ["1991", "1993", "1998", "2000"],
                        correct: 1
                    },
                    {
                        question: "Как звали первого русского царя?",
                        options: ["Иван III", "Иван IV", "Петр I", "Василий III"],
                        correct: 1
                    }
                ]
            },
            biology: {
                title: "Биология",
                timeLimit: 18,
                questions: [
                    {
                        question: "Какой органоид называют «энергетической станцией» клетки?",
                        options: ["Ядро", "Рибосома", "Митохондрия", "Хлоропласт"],
                        correct: 2
                    },
                    {
                        question: "Сколько хромосом в клетках человека?",
                        options: ["23", "46", "48", "50"],
                        correct: 1
                    },
                    {
                        question: "Какой процесс обеспечивает поступление кислорода в организм?",
                        options: ["Пищеварение", "Дыхание", "Кровообращение", "Выделение"],
                        correct: 1
                    },
                    {
                        question: "К какому царству относятся дрожжи?",
                        options: ["Растения", "Животные", "Грибы", "Бактерии"],
                        correct: 2
                    },
                    {
                        question: "Какой витамин вырабатывается в коже под воздействием солнечного света?",
                        options: ["Витамин A", "Витамин C", "Витамин D", "Витамин K"],
                        correct: 2
                    },
                    {
                        question: "Что такое фотосинтез?",
                        options: [
                            "Процесс поглощения воды корнями",
                            "Процесс образования органических веществ из неорганических на свету",
                            "Процесс деления клеток",
                            "Процесс дыхания растений"
                        ],
                        correct: 1
                    },
                    {
                        question: "Какой ученый считается основателем генетики?",
                        options: ["Чарльз Дарвин", "Грегор Мендель", "Карл Линней", "Луи Пастер"],
                        correct: 1
                    },
                    {
                        question: "Как называется наука о птицах?",
                        options: ["Энтомология", "Орнитология", "Ихтиология", "Герпетология"],
                        correct: 1
                    },
                    {
                        question: "Какой кровеносный сосуд несет кровь от сердца?",
                        options: ["Артерия", "Вена", "Капилляр", "Лимфатический сосуд"],
                        correct: 0
                    },
                    {
                        question: "Что такое биосфера?",
                        options: [
                            "Оболочка Земли, заселенная живыми организмами",
                            "Совокупность всех растений на Земле",
                            "Совокупность всех животных на Земле",
                            "Почвенный слой Земли"
                        ],
                        correct: 0
                    }
                ]
            },
            english: {
                title: "Английский язык",
                timeLimit: 12,
                questions: [
                    {
                        question: "Выберите правильный перевод слова 'яблоко'",
                        options: ["apple", "orange", "banana", "grape"],
                        correct: 0
                    },
                    {
                        question: "Как будет 'стол' по-английски?",
                        options: ["chair", "table", "desk", "shelf"],
                        correct: 1
                    },
                    {
                        question: "Выберите правильную форму глагола 'to be' для местоимения 'I' в настоящем времени",
                        options: ["am", "is", "are", "be"],
                        correct: 0
                    },
                    {
                        question: "Как переводится фраза 'How are you?'?",
                        options: ["Как тебя зовут?", "Как дела?", "Где ты живешь?", "Сколько тебе лет?"],
                        correct: 1
                    },
                    {
                        question: "Выберите правильный артикль: ___ cat",
                        options: ["a", "an", "the", "-"],
                        correct: 0
                    },
                    {
                        question: "Какое время используется для выражения действия в настоящем в момент речи?",
                        options: ["Present Simple", "Present Continuous", "Past Simple", "Future Simple"],
                        correct: 1
                    },
                    {
                        question: "Как будет 'книга' по-английски?",
                        options: ["book", "copy", "page", "text"],
                        correct: 0
                    },
                    {
                        question: "Выберите правильный порядок слов в английском предложении",
                        options: [
                            "Подлежащее + Сказуемое + Дополнение",
                            "Сказуемое + Подлежащее + Дополнение", 
                            "Дополнение + Подлежащее + Сказуемое",
                            "Сказуемое + Дополнение + Подлежащее"
                        ],
                        correct: 0
                    }
                ]
            }
        };

        // Переменные состояния
        let currentTest = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let startTime = null;
        let timerInterval = null;
        let timeLeft = 0;
        let currentStudent = null;
        const ADMIN_PASSWORD = "teacher123";

        // Элементы DOM
        const loginContainerEl = document.getElementById('login-container');
        const testSelectionEl = document.getElementById('test-selection');
        const testContainerEl = document.getElementById('test-container');
        const resultsEl = document.getElementById('results');
        const adminPanelEl = document.getElementById('admin-panel');
        const questionContainerEl = document.getElementById('question-container');
        const progressFillEl = document.getElementById('progress-fill');
        const progressTextEl = document.getElementById('progress-text');
        const timerEl = document.getElementById('timer');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const retryBtn = document.getElementById('retry-btn');
        const finishBtn = document.getElementById('finish-btn');
        const finalScoreEl = document.getElementById('final-score');
        const gradeEl = document.getElementById('grade');
        const resultMessageEl = document.getElementById('result-message');
        const resultsListEl = document.getElementById('results-list');
        const timeSpentEl = document.getElementById('time-spent');
        const completionDateEl = document.getElementById('completion-date');
        const startTestBtn = document.getElementById('start-test-btn');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const backToLoginBtn = document.getElementById('back-to-login');
        const backFromAdminBtn = document.getElementById('back-from-admin');
        const adminAccessBtn = document.getElementById('admin-access-btn');
        const adminPasswordEl = document.getElementById('admin-password');
        const adminControlsEl = document.getElementById('admin-controls');
        const adminContentEl = document.getElementById('admin-content');
        const clearResultsBtn = document.getElementById('clear-results-btn');
        const exportResultsBtn = document.getElementById('export-results-btn');
        const resultsTableBody = document.getElementById('results-table-body');
        const noResultsEl = document.getElementById('no-results');
        const applyFilterBtn = document.getElementById('apply-filter');
        const filterNameEl = document.getElementById('filter-name');
        const filterTestEl = document.getElementById('filter-test');
        const filterClassEl = document.getElementById('filter-class');
        const studentNameEl = document.getElementById('student-name');
        const studentClassEl = document.getElementById('student-class');
        const currentStudentNameEl = document.getElementById('current-student-name');
        const currentTestNameEl = document.getElementById('current-test-name');
        const resultStudentNameEl = document.getElementById('result-student-name');
        const resultTestNameEl = document.getElementById('result-test-name');

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            // Проверка, есть ли сохраненные данные о студенте
            const savedStudent = localStorage.getItem('lastStudent');
            if (savedStudent) {
                try {
                    const student = JSON.parse(savedStudent);
                    document.getElementById('last-name').value = student.lastName || '';
                    document.getElementById('first-name').value = student.firstName || '';
                    document.getElementById('middle-name').value = student.middleName || '';
                    document.getElementById('class').value = student.class || '';
                } catch (e) {
                    console.log('Не удалось загрузить данные последнего студента');
                }
            }
            
            // Обработчики для кнопок
            startTestBtn.addEventListener('click', startTestProcess);
            adminLoginBtn.addEventListener('click', () => showScreen('admin-panel'));
            backToLoginBtn.addEventListener('click', () => showScreen('login-container'));
            backFromAdminBtn.addEventListener('click', () => showScreen('login-container'));
            adminAccessBtn.addEventListener('click', checkAdminPassword);
            clearResultsBtn.addEventListener('click', clearAllResults);
            exportResultsBtn.addEventListener('click', exportResultsToJSON);
            applyFilterBtn.addEventListener('click', loadResultsTable);
            retryBtn.addEventListener('click', () => {
                showScreen('test-selection');
                resetTest();
            });
            finishBtn.addEventListener('click', () => {
                showScreen('login-container');
                resetTest();
            });
            
            // Обработчики для навигации теста
            prevBtn.addEventListener('click', showPreviousQuestion);
            nextBtn.addEventListener('click', showNextQuestion);
            submitBtn.addEventListener('click', finishTest);
            
            // Обработчики для вкладок админ-панели
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Обработчики для карточек тестов
            document.querySelectorAll('.test-card').forEach(card => {
                card.addEventListener('click', () => {
                    const testId = card.getAttribute('data-test');
                    startTest(testId);
                });
            });
        });

        // Начать процесс тестирования (ввод ФИО)
        function startTestProcess() {
            const lastName = document.getElementById('last-name').value.trim();
            const firstName = document.getElementById('first-name').value.trim();
            const middleName = document.getElementById('middle-name').value.trim();
            const studentClass = document.getElementById('class').value;
            
            if (!lastName || !firstName) {
                alert('Пожалуйста, введите хотя бы фамилию и имя');
                return;
            }
            
            // Сохраняем данные студента
            currentStudent = {
                lastName,
                firstName,
                middleName,
                class: studentClass,
                fullName: `${lastName} ${firstName} ${middleName}`.trim(),
                date: new Date().toISOString()
            };
            
            // Сохраняем данные студента для будущего использования
            localStorage.setItem('lastStudent', JSON.stringify({
                lastName,
                firstName,
                middleName,
                class: studentClass
            }));
            
            // Обновляем отображение информации о студенте
            studentNameEl.textContent = currentStudent.fullName;
            studentClassEl.textContent = studentClass ? `Класс: ${studentClass}` : 'Класс: не указан';
            currentStudentNameEl.textContent = currentStudent.fullName;
            resultStudentNameEl.textContent = currentStudent.fullName;
            
            // Переходим к выбору теста
            showScreen('test-selection');
        }

        // Начать тест
        function startTest(testId) {
            currentTest = tests[testId];
            currentQuestionIndex = 0;
            userAnswers = new Array(currentTest.questions.length).fill(null);
            timeLeft = currentTest.timeLimit * 60;
            startTime = new Date();
            
            // Обновляем отображение названия теста
            currentTestNameEl.textContent = `Тест: ${currentTest.title}`;
            resultTestNameEl.textContent = `Тест: ${currentTest.title}`;
            
            showScreen('test-container');
            startTimer();
            loadQuestion();
            updateProgress();
        }

        // Показать определенный экран
        function showScreen(screenId) {
            loginContainerEl.classList.remove('active');
            testSelectionEl.classList.remove('active');
            testContainerEl.classList.remove('active');
            resultsEl.classList.remove('active');
            adminPanelEl.classList.remove('active');
            
            document.getElementById(screenId).classList.add('active');
            
            // Если показываем админ-панель, загружаем результаты
            if (screenId === 'admin-panel') {
                loadResultsTable();
            }
        }

        // Запустить таймер
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    finishTest();
                }
            }, 1000);
        }

        // Обновить отображение таймера
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerEl.textContent = `Осталось времени: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Загрузить текущий вопрос
        function loadQuestion() {
            const question = currentTest.questions[currentQuestionIndex];
            
            let optionsHtml = '';
            question.options.forEach((option, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index;
                optionsHtml += `
                    <div class="option ${isSelected ? 'selected' : ''}" data-index="${index}">
                        ${option}
                    </div>
                `;
            });
            
            questionContainerEl.innerHTML = `
                <div class="question-container">
                    <div class="question-number">Вопрос ${currentQuestionIndex + 1} из ${currentTest.questions.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options-container">${optionsHtml}</div>
                </div>
            `;
            
            // Обработчики для вариантов ответа
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', () => {
                    const selectedIndex = parseInt(option.getAttribute('data-index'));
                    userAnswers[currentQuestionIndex] = selectedIndex;
                    
                    // Сбросить выделение у всех вариантов
                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Выделить выбранный вариант
                    option.classList.add('selected');
                    
                    // Активировать кнопку "Завершить тест", если это последний вопрос
                    if (currentQuestionIndex === currentTest.questions.length - 1) {
                        submitBtn.style.display = 'block';
                        nextBtn.style.display = 'none';
                    }
                });
            });
            
            // Обновить состояние кнопок навигации
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === currentTest.questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }

        // Обновить прогресс
        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / currentTest.questions.length) * 100;
            progressFillEl.style.width = `${progress}%`;
            progressTextEl.textContent = `Вопрос ${currentQuestionIndex + 1} из ${currentTest.questions.length}`;
        }

        // Показать предыдущий вопрос
        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
                updateProgress();
            }
        }

        // Показать следующий вопрос
        function showNextQuestion() {
            if (currentQuestionIndex < currentTest.questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
                updateProgress();
            }
        }

        // Завершить тест
        function finishTest() {
            clearInterval(timerInterval);
            
            // Подсчет результатов
            let correctAnswers = 0;
            currentTest.questions.forEach((question, index) => {
                if (userAnswers[index] === question.correct) {
                    correctAnswers++;
                }
            });
            
            const score = Math.round((correctAnswers / currentTest.questions.length) * 100);
            const timeSpent = new Date() - startTime;
            const minutesSpent = Math.floor(timeSpent / 60000);
            const secondsSpent = Math.floor((timeSpent % 60000) / 1000);
            const completionDate = new Date();
            
            // Сохранение результата
            saveResult(score, minutesSpent, secondsSpent, completionDate);
            
            // Отображение результатов
            finalScoreEl.textContent = `${score}%`;
            gradeEl.textContent = getGrade(score);
            resultMessageEl.textContent = getResultMessage(score);
            timeSpentEl.textContent = `Время прохождения: ${minutesSpent} мин ${secondsSpent} сек`;
            completionDateEl.textContent = `Дата прохождения: ${completionDate.toLocaleDateString('ru-RU')} ${completionDate.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}`;
            
            // Детализация результатов
            let resultsHtml = '';
            currentTest.questions.forEach((question, index) => {
                const userAnswerIndex = userAnswers[index];
                const isCorrect = userAnswerIndex === question.correct;
                const userAnswer = userAnswerIndex !== null ? question.options[userAnswerIndex] : "Нет ответа";
                const correctAnswer = question.options[question.correct];
                
                resultsHtml += `
                    <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <div>
                            <strong>Вопрос ${index + 1}:</strong> ${question.question}
                            <div style="margin-top: 5px; font-size: 0.9rem;">
                                Ваш ответ: ${userAnswer}<br>
                                ${!isCorrect ? `Правильный ответ: ${correctAnswer}` : ''}
                            </div>
                        </div>
                        <div>
                            ${isCorrect ? '<i class="fas fa-check"></i>' : '<i class="fas fa-times"></i>'}
                        </div>
                    </div>
                `;
            });
            
            resultsListEl.innerHTML = resultsHtml;
            
            showScreen('results');
        }

        // Сохранить результат в localStorage
        function saveResult(score, minutes, seconds, date) {
            // Получаем существующие результаты
            let allResults = JSON.parse(localStorage.getItem('testResults')) || [];
            
            // Создаем объект результата
            const result = {
                id: Date.now(), // уникальный ID
                student: currentStudent,
                test: {
                    id: Object.keys(tests).find(key => tests[key] === currentTest),
                    title: currentTest.title
                },
                score: score,
                grade: getGrade(score),
                correctAnswers: userAnswers.filter((answer, index) => answer === currentTest.questions[index].correct).length,
                totalQuestions: currentTest.questions.length,
                timeSpent: `${minutes} мин ${seconds} сек`,
                date: date.toISOString(),
                userAnswers: userAnswers
            };
            
            // Добавляем новый результат
            allResults.push(result);
            
            // Сохраняем обратно в localStorage
            localStorage.setItem('testResults', JSON.stringify(allResults));
            
            console.log('Результат сохранен:', result);
        }

        // Проверить пароль администратора
        function checkAdminPassword() {
            const password = adminPasswordEl.value;
            
            if (password === ADMIN_PASSWORD) {
                adminControlsEl.style.display = 'flex';
                adminContentEl.style.display = 'block';
                adminPasswordEl.style.borderColor = '#28a745';
                loadResultsTable();
            } else {
                alert('Неверный пароль!');
                adminPasswordEl.style.borderColor = '#dc3545';
                adminPasswordEl.value = '';
                adminPasswordEl.focus();
            }
        }

        // Загрузить таблицу результатов
        function loadResultsTable() {
            const allResults = JSON.parse(localStorage.getItem('testResults')) || [];
            
            // Применяем фильтры
            const filterName = filterNameEl.value.toLowerCase();
            const filterTest = filterTestEl.value;
            const filterClass = filterClassEl.value;
            
            const filteredResults = allResults.filter(result => {
                const fullName = result.student.fullName.toLowerCase();
                const testId = result.test.id;
                const studentClass = result.student.class || '';
                
                return (!filterName || fullName.includes(filterName)) &&
                       (!filterTest || testId === filterTest) &&
                       (!filterClass || studentClass === filterClass);
            });
            
            // Сортируем по дате (новые сначала)
            filteredResults.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Очищаем таблицу
            resultsTableBody.innerHTML = '';
            
            if (filteredResults.length === 0) {
                noResultsEl.style.display = 'block';
                return;
            }
            
            noResultsEl.style.display = 'none';
            
            // Заполняем таблицу
            filteredResults.forEach(result => {
                const date = new Date(result.date);
                const formattedDate = date.toLocaleDateString('ru-RU');
                const formattedTime = date.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'});
                
                // Определяем badge для оценки
                let badgeClass = 'badge-danger';
                if (result.score >= 75) badgeClass = 'badge-success';
                else if (result.score >= 60) badgeClass = 'badge-warning';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${result.student.fullName}</td>
                    <td>${result.student.class || 'Не указан'}</td>
                    <td>${result.test.title}</td>
                    <td>${result.score}% (${result.correctAnswers}/${result.totalQuestions})</td>
                    <td><span class="badge ${badgeClass}">${result.grade}</span></td>
                    <td>${formattedDate}</td>
                    <td>${formattedTime}</td>
                `;
                resultsTableBody.appendChild(row);
            });
            
            // Обновляем статистику
            updateStats(filteredResults);
        }

        // Обновить статистику
        function updateStats(results) {
            const statsContent = document.getElementById('stats-content');
            
            if (results.length === 0) {
                statsContent.innerHTML = '<p>Нет данных для статистики</p>';
                return;
            }
            
            // Подсчет статистики
            const totalTests = results.length;
            const avgScore = Math.round(results.reduce((sum, result) => sum + result.score, 0) / totalTests);
            
            // Распределение по тестам
            const testDistribution = {};
            results.forEach(result => {
                const testName = result.test.title;
                testDistribution[testName] = (testDistribution[testName] || 0) + 1;
            });
            
            // Распределение по оценкам
            const gradeDistribution = {
                'Отлично': 0,
                'Хорошо': 0,
                'Удовлетворительно': 0,
                'Неудовлетворительно': 0
            };
            
            results.forEach(result => {
                gradeDistribution[result.grade] = (gradeDistribution[result.grade] || 0) + 1;
            });
            
            // Формируем HTML статистики
            let statsHtml = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4><i class="fas fa-chart-line"></i> Общая статистика</h4>
                        <p>Всего пройдено тестов: <strong>${totalTests}</strong></p>
                        <p>Средний результат: <strong>${avgScore}%</strong></p>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4><i class="fas fa-book"></i> Распределение по тестам</h4>
            `;
            
            for (const [testName, count] of Object.entries(testDistribution)) {
                const percentage = Math.round((count / totalTests) * 100);
                statsHtml += `<p>${testName}: <strong>${count}</strong> (${percentage}%)</p>`;
            }
            
            statsHtml += `
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4><i class="fas fa-star"></i> Распределение по оценкам</h4>
            `;
            
            for (const [grade, count] of Object.entries(gradeDistribution)) {
                if (count > 0) {
                    const percentage = Math.round((count / totalTests) * 100);
                    statsHtml += `<p>${grade}: <strong>${count}</strong> (${percentage}%)</p>`;
                }
            }
            
            statsHtml += `
                    </div>
                </div>
            `;
            
            statsContent.innerHTML = statsHtml;
        }

        // Очистить все результаты
        function clearAllResults() {
            if (confirm('Вы уверены, что хотите удалить все результаты тестирования? Это действие нельзя отменить.')) {
                localStorage.removeItem('testResults');
                loadResultsTable();
                alert('Все результаты были удалены.');
            }
        }

        // Экспорт результатов в JSON
        function exportResultsToJSON() {
            const allResults = JSON.parse(localStorage.getItem('testResults')) || [];
            
            if (allResults.length === 0) {
                alert('Нет результатов для экспорта.');
                return;
            }
            
            const dataStr = JSON.stringify(allResults, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `results_testing_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert(`Результаты экспортированы в файл: ${exportFileDefaultName}`);
        }

        // Переключение вкладок в админ-панели
        function switchTab(tabId) {
            // Сбрасываем активные классы
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Активируем выбранную вкладку
            document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Получить оценку по баллам
        function getGrade(score) {
            if (score >= 90) return "Отлично";
            if (score >= 75) return "Хорошо";
            if (score >= 60) return "Удовлетворительно";
            return "Неудовлетворительно";
        }

        // Получить сообщение по результатам
        function getResultMessage(score) {
            if (score >= 90) return "Превосходный результат! Вы отлично знаете материал.";
            if (score >= 75) return "Хороший результат! Вы хорошо знаете материал.";
            if (score >= 60) return "Удовлетворительный результат. Есть над чем поработать.";
            return "Вам нужно лучше подготовиться. Рекомендуем повторить материал.";
        }

        // Сброс теста
        function resetTest() {
            currentTest = null;
            currentQuestionIndex = 0;
            userAnswers = [];
            startTime = null;
            timeLeft = 0;
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }
    </script>
</body>
</html>